<!doctype html>
<html lang="th">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>gxHo Break-Timer ‚Äî NOAH345 üíú | ‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö - Break Timer</title>
  <link rel="stylesheet" href="styles.css">
  <script src="config.js"></script>
  <script src="app.js"></script>
  <style>
    /* Basic override to look like index page */
    body{font-family: Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; background: linear-gradient(180deg,#f8fbff,#f2f7ff); padding:36px;}
    .card{max-width:980px;margin:16px auto;padding:20px;border-radius:12px;background:#ffffff;border:1px solid rgba(107,70,193,0.06);box-shadow:0 8px 24px rgba(12,12,15,0.06);}
    h1{font-size:20px;margin:0 0 8px;color:#1f2937}
    p.lead{color:#475569;margin:6px 0 18px}
    .row{display:flex;gap:12px;align-items:center;flex-wrap:wrap}
    label{font-size:14px;color:#374151}
    input[type=password], input[type=text]{padding:10px;border:1px solid #e6e9ef;border-radius:8px;width:320px;}
    .btn{background:#6b46c1;color:#fff;border:0;padding:10px 14px;border-radius:10px;cursor:pointer;box-shadow:inset 0 -2px 0 rgba(0,0,0,0.06)}
    .btn.ghost{background:transparent;color:#374151;border:1px solid #e6e9ef}
    .section-note{background:#f8f7ff;padding:12px;border-radius:8px;border:1px dashed #eee;color:#4b5563;margin-top:12px}
    .muted{color:#6b7280;font-size:13px}
  </style>
</head>
<body>
  <div class="noah-brand">NOAH345 üíú ‚Äî gxHo Break-Timer</div>

  <div class="card">
    <h1>‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö (PIN)</h1>
    <p class="lead">‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡πâ‡∏ß‡∏¢ PIN ‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏ß‡πâ ‡∏´‡∏≤‡∏Å‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ï‡∏±‡πâ‡∏á PIN ‡πÉ‡∏´‡πâ‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÉ‡∏´‡∏°‡πà‡∏î‡πâ‡∏≤‡∏ô‡∏•‡πà‡∏≤‡∏á‡∏Ñ‡πà‡∏∞</p>

    <div style="display:flex;gap:16px;align-items:center;flex-wrap:wrap;margin-bottom:12px;">
      <div style="flex:1;min-width:280px;">
        <label>PIN / Password</label><br/>
        <input id="pinLogin" type="password" placeholder="‡∏Å‡∏£‡∏≠‡∏Å PIN ‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì">
      </div>
      <div style="align-self:flex-end">
        <button id="loginBtn" class="btn">‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö</button>
      </div>
    </div>

    <div class="section-note">
      <div style="display:flex;justify-content:space-between;align-items:center;gap:12px;flex-wrap:wrap;">
        <div>
          <div class="muted">‡πÉ‡∏ä‡πâ GitHub Gist Token ‡∏Å‡∏•‡∏≤‡∏á (‡∏ï‡∏±‡πâ‡∏á‡∏Ñ‡πà‡∏≤‡πÇ‡∏î‡∏¢‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•)</div>
          <div class="muted" style="margin-top:6px">‡∏ñ‡πâ‡∏≤‡πÑ‡∏°‡πà‡∏°‡∏µ token ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏∞‡πÉ‡∏ä‡πâ anonymous gist ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏Å‡πá‡∏ö‡πÉ‡∏ô localStorage</div>
        </div>
        <div style="min-width:160px;text-align:right">
          <button id="goIndex" class="btn ghost">‡πÑ‡∏õ‡∏¢‡∏±‡∏á‡πÅ‡∏≠‡∏õ‡∏´‡∏•‡∏±‡∏Å</button>
        </div>
      </div>
    </div>

    <hr style="margin:18px 0; border:none; border-top:1px solid #f1f3f5">

    <h2 style="font-size:16px;margin:0 0 8px">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ PIN? ‡∏™‡∏£‡πâ‡∏≤‡∏á PIN ‡πÉ‡∏´‡∏°‡πà</h2>
    <div style="display:flex;gap:12px;align-items:center;flex-wrap:wrap;margin-bottom:8px;">
      <input id="newPin" type="password" placeholder="‡πÉ‡∏™‡πà PIN ‡πÉ‡∏´‡∏°‡πà">
      <input id="confirmPin" type="password" placeholder="‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô PIN">
      <button id="createPinBtn" class="btn">‡∏™‡∏£‡πâ‡∏≤‡∏á PIN</button>
      <label style="display:flex;align-items:center;gap:6px;margin-left:8px" class="muted">
        <input type="checkbox" id="backupCentralChk"> ‡∏™‡∏≥‡∏£‡∏≠‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á Gist ‡∏Å‡∏•‡∏≤‡∏á
      </label>
    </div>
    <div class="muted" style="margin-bottom:12px">‡∏´‡∏≤‡∏Å‡∏™‡∏≥‡∏£‡∏≠‡∏á ‡∏à‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡∏£‡∏´‡∏±‡∏™‡∏î‡πâ‡∏ß‡∏¢ PIN ‡πÅ‡∏•‡∏∞‡∏≠‡∏±‡∏õ‡πÇ‡∏´‡∏•‡∏î‡πÑ‡∏õ‡∏¢‡∏±‡∏á Gist ‡∏Å‡∏•‡∏≤‡∏á‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏ß‡πâ‡πÉ‡∏ô config.js</div>

    <h2 style="font-size:16px;margin:0 0 8px">‡∏Å‡∏π‡πâ‡∏Ñ‡∏∑‡∏ô PIN ‡∏î‡πâ‡∏ß‡∏¢ Recovery Code</h2>
    <div style="display:flex;gap:8px;align-items:center;flex-wrap:wrap">
      <input id="recoveryInput" type="text" placeholder="‡∏ß‡∏≤‡∏á Recovery Code ‡∏ó‡∏µ‡πà‡πÑ‡∏î‡πâ" style="width:520px">
      <button id="useRecoveryBtn" class="btn">‡πÉ‡∏ä‡πâ Recovery Code</button>
    </div>

    <div style="margin-top:16px" class="muted">‡∏´‡∏≤‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏≤‡∏£‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ä‡πà‡∏ß‡∏¢‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏° ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏ú‡∏π‡πâ‡∏î‡∏π‡πÅ‡∏•‡∏£‡∏∞‡∏ö‡∏ö</div>
  </div>

<script>
// keep existing handlers in app.js used: hashPinLocal, saveSettingsLocal, encryptJSON, saveEncryptedToGist, useRecoveryCode
document.addEventListener('DOMContentLoaded', ()=>{
  const loginBtn = document.getElementById('loginBtn');
  const pinLogin = document.getElementById('pinLogin');
  const newPin = document.getElementById('newPin');
  const confirmPin = document.getElementById('confirmPin');
  const createPinBtn = document.getElementById('createPinBtn');
  const backupChk = document.getElementById('backupCentralChk');
  const recoveryInput = document.getElementById('recoveryInput');
  const useRecoveryBtn = document.getElementById('useRecoveryBtn');
  const goIndex = document.getElementById('goIndex');

  if(loginBtn){ loginBtn.addEventListener('click', async ()=>{
    const p = pinLogin.value.trim();
    if(!p) return alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å PIN');
    if(typeof hashPinLocal !== 'function') return alert('‡∏£‡∏∞‡∏ö‡∏ö‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏° ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà');
    const h = await hashPinLocal(p);
    const s = JSON.parse(localStorage.getItem('breaker_settings_v1')||'{}');
    if(s.pinHash && s.pinHash === h){
      // set session valid for 8 hours
      const session = { createdAt: Date.now(), expiresAt: Date.now() + (8*60*60*1000) };
      localStorage.setItem('session_auth_v1', JSON.stringify(session));
      alert('‡∏•‡πá‡∏≠‡∏Å‡∏≠‡∏¥‡∏ô‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à');
      window.location.href = 'index.html';
    }else{
      alert('PIN ‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á');
    }
  });

  if(createPinBtn){ createPinBtn.addEventListener('click', async ()=>{
    const a = newPin.value.trim(); const b = confirmPin.value.trim();
    if(!a || !b) return alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏Å‡∏£‡∏≠‡∏Å PIN ‡πÅ‡∏•‡∏∞‡∏¢‡∏∑‡∏ô‡∏¢‡∏±‡∏ô');
    if(a !== b) return alert('PIN ‡πÑ‡∏°‡πà‡∏ï‡∏£‡∏á‡∏Å‡∏±‡∏ô');
    if(typeof hashPinLocal !== 'function') return alert('‡∏£‡∏∞‡∏ö‡∏ö‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏û‡∏£‡πâ‡∏≠‡∏°');
    const h = await hashPinLocal(a);
    saveSettingsLocal({ pinHash: h });
    alert('‡∏™‡∏£‡πâ‡∏≤‡∏á PIN ‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢');
    if(backupChk.checked && window.__CENTRAL_GIST && window.__CENTRAL_GIST.token){
      try{
        const payload = getAllDataForSync();
        const encObj = await encryptJSON(payload, a);
        const newId = await saveEncryptedToGist(encObj);
        const s = JSON.parse(localStorage.getItem('breaker_settings_v1')||'{}');
        s.anonGistId = newId; localStorage.setItem('breaker_settings_v1', JSON.stringify(s));
        alert('‡∏™‡∏≥‡∏£‡∏≠‡∏á‡πÑ‡∏õ‡∏¢‡∏±‡∏á Gist ‡∏Å‡∏•‡∏≤‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢\nGist ID: ' + newId);
      }catch(e){ console.error(e); alert('‡∏Å‡∏≤‡∏£‡∏™‡∏≥‡∏£‡∏≠‡∏á‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß: ' + e.message); }
    }
  });

  if(useRecoveryBtn){ useRecoveryBtn.addEventListener('click', async ()=>{
    const code = recoveryInput.value.trim();
    if(!code) return alert('‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏ß‡∏≤‡∏á Recovery Code');
    try{
      await useRecoveryCode(code);
      alert('‡∏Å‡∏π‡πâ PIN ‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à ‡∏Å‡∏£‡∏∏‡∏ì‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏£‡∏∞‡∏ö‡∏ö‡∏î‡πâ‡∏ß‡∏¢ PIN ‡πÉ‡∏´‡∏°‡πà');
    }catch(e){ alert('‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡∏Å‡∏π‡πâ PIN: ' + e.message); }
  });

  if(goIndex){ goIndex.addEventListener('click', ()=>{ window.location.href='index.html'; }); }
});
</script>

  <div style="max-width:980px;margin:18px auto 36px;text-align:center;color:var(--noah-muted);font-size:13px;">‡∏£‡∏∞‡∏ö‡∏ö‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏ß‡∏•‡∏≤ gxHo Break-Timer ‚Äî ‡∏û‡∏±‡∏í‡∏ô‡∏≤‡πÇ‡∏î‡∏¢ NOAH345 üíú</div>
</body>
</html>
